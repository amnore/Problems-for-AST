# ç¬¬å…«å‘¨è„‘åŠ›é£Žæš´ç­”æ¡ˆ

ä¸çŸ¥ä¸ŠæœŸçš„é¢˜ç›®æœ‰æ²¡æœ‰è®©åœ¨åº§å„ä½å¤§ä½¬è¿‡æŠŠç˜¾

ç¬¬ä¸€æ¬¡å‡ºç›¸å¯¹è¾ƒéš¾çš„é¢˜ç›®æˆ‘ä»¬ä¹Ÿå¾ˆå¿å¿‘,
ä¸çŸ¥åå“ä¼šå¦‚ä½•

æ‰€ä»¥çœ‹å®˜ä»¬å¦‚æžœæœ‰ä»€ä¹ˆæ„è§ä¸€å®šè¦å‘æˆ‘ä»¬æå‘€ï¼Œæœ‰äº†è¯¸ä½çš„å‚ä¸Žæˆ‘ä»¬çš„æ¨¡å—æ‰èƒ½è¶ŠåŠžè¶Šå¥½

é‚£è¯ä¸å¤šè¯´ï¼Œå¾…æˆ‘ä»¬æš´åŠ›æ‹†è§£ä¸ŠæœŸå°é¢˜


## é¢˜ç›®ä¸€ï¼šä¸é‚£ä¹ˆç®€å•çš„å¾®ç§¯åˆ†

ä¸ŠæœŸå¾®ç§¯åˆ†æœ‰ä¸€å®šéš¾åº¦ï¼Œä¸¥è°¨èµ·è§ï¼Œä¾¿ç›´æŽ¥é™„ä¸Šä¸“ä¸šè§£ç­”

$f(x)$ ä¸ºæŠ½è±¡å‡½æ•°ï¼Œç”±ï¼‰ä¸ºæŠ½è±¡å‡½æ•°ï¼Œç”±é¢˜è®¾æ¡ä»¶å¯çŸ¥ï¼Œåªèƒ½è€ƒè™‘æžé™å®šä¹‰ã€‚

(1) è®¾ 
$\lim_{x\rightarrow+\infty} (f(x+1)-f(x)) = A.$  
ä»»ç»™ $\epsilon>0$ï¼Œç”±æžé™å®šä¹‰å¯çŸ¥å¿…å®šå­˜åœ¨æ­£æ•° $X_0>a$ï¼Œå½“ $x\ge X_0$ æ—¶ï¼Œæ€»æœ‰
$$|f(x+1)-f(x)-A|<\frac \epsilon 3.$$  
è®¾$x>X_0+1$ï¼ŒäºŽæ˜¯å¿…å®šå­˜åœ¨æ­£æ•´æ•°$n$ï¼Œä½¿
$$n \le x-X_0 < x+1,$$  
ä»¤ $\tau = x-X_0-n$ï¼Œåˆ™ $0\le\tau < 1,x=X_0+\tau+n.$  
$$\frac {f(x)} x - A = \frac n x [\frac {f(x)-f(X_0+\tau)} n -A] + \frac {f(X_0 + \tau)} x -\frac {X_0+\tau} x A.$$  
ç”±äºŽ $n<x$ ï¼Œå¯çŸ¥
$$|\frac n x [\frac {f(x)-f(X_0+\tau)} n -A]|\le |\frac {f(X_0+\tau+n)-f(X_0+\tau)} n -A|$$  
$$= \frac 1 n |\sum_{k=1}^n [f(X_0+\tau+k)-f(X_0+\tau+k-1)-A]|$$  
$$\le \frac 1 n \sum_{k=1}^n|f(X_0+\tau+k)-f(X_0+\tau+k-1)-A|$$  
$$\le \frac 1 n \cdot \frac {n\epsilon} 3 = \frac \epsilon 3.$$  
ç”±é¢˜è®¾çŸ¥ $f(x)$ åœ¨ $X_0\le x < X_0 +1$ ä¸Šæœ‰ç•Œï¼Œæ•…å­˜åœ¨æ­£æ•° $X_1$ ï¼Œå½“ $x>X_1$ æ—¶ï¼Œæ€»æœ‰
$$|\frac {f(X_0+\tau)} x|<\frac \epsilon 3.$$  
åŒæ ·å­˜åœ¨æ­£æ•° $X_2$ ï¼Œå½“ $x>X_2$ æ—¶ï¼Œæ€»æœ‰
$$|\frac {(X_0+1)A} x|<\frac \epsilon 3,$$  
ä»¤ $X=\max{X_0+1,X_1,X_2}$ ï¼Œå¯çŸ¥å½“ $x>X$ æ—¶ï¼Œå¿…æœ‰
$$|\frac {f(x)} x -A| < \frac \epsilon 3 + \frac \epsilon 3 + \frac \epsilon 3 = \epsilon,$$  
æ•…
$$\lim_{x\leftarrow+\infty} \frac {f(x)} x = A.$$

(2) 

åŽŸé¢˜ä¸Šæœ¬æ²¡æœ‰â€œå‡è®¾ç­‰å¼ä¸¤ä¾§æžé™å‡å­˜åœ¨æˆ–æ— ç©·å¤§â€è¿™ä¸ªæ¡ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¤f(x)=sinâ¡xæ—¶å‡ºçŽ°äº†bug

æ— å¥ˆä¹‹ä¸‹æˆ‘æ‰åŠ äº†è¿™ä¸ªæ¡ä»¶ï¼Œä¸è¿‡æˆ‘è‡ªå·±å¾ˆæ‡µï¼Œæ‰€ä»¥å¦‚æžœæœ‰å¤§ä½¬æ˜Žç™½è¿™æ˜¯æ€Žä¹ˆå›žäº‹çš„è¯æ¬¢è¿Žç§æˆ³å­¦æœ¯å¢™æ•™æ•™æˆ‘è¿™ä¸ªæ¸£æ¸£

## é¢˜ç›®äºŒï¼šæ„¤æ€’çš„å°é¸Ÿ

ï¼ˆæ®æŸäº›åŒå­¦è¯´è¿™æ¬¡çš„é¢˜çœ‹ä¸æ‡‚ã€‚ã€‚ã€‚æˆ‘çš„é”™ï¼Œæˆ‘ä»¥åŽå†ä¹Ÿä¸ä¼šèµ¶å·¥äº†ã€‚ï¼‰

### é¦–å…ˆæ˜¯å„ç§è§£æ³•è·‘çš„æ—¶é—´

|       n        |  1000   |  2000  |  3000  |
| :------------: | :-----: | :----: | :----: |
|    $O(n^3)$    | 0.585s  | 4.684s | 14.85s |
| $O(n^2\log n)$ | 0.135s  | 0.78s  | 1.912s |
|    $O(n^2)$    | 0.0875s | 0.522s | 1.116s |

æ³¨ï¼š
è¿™æ˜¯æˆ‘åœ¨è‡ªå·±çš„æ¸£ç”µè„‘çš„ WSL ä¸Šè·‘çš„ï¼Œç¼–è¯‘å‚æ•°ä¸º g++ -Ofast ï¼Œå¤§å®¶è·‘çš„æ—¶é—´åº”è¯¥ä¼šæ¯”è¿™ä¸ªå°‘ã€‚  
æ‰€ç”¨æ•°æ®ä¸ºæµ‹è¯•æ•°æ®ä¸­ç›¸åº” $n$ çš„æ•°æ®ï¼Œç»“æžœä¸ºå„ä¸ªæ•°æ®å–å¹³å‡å€¼å¾—åˆ°ã€‚

ï¼ˆæˆ‘æ²¡æ‰¾åˆ°åŠžæ³•æŠŠ $O(n^2)$ ç‰ˆæœ¬çš„æ—¶é—´åŽ‹è¿›ä¸€ç§’ï¼Œæœ‰å“ªä½ dailao æ„¿æ„å¸®å¸®æˆ‘å—ï¼Ÿï¼‰

### ç®€å•éš¾åº¦è§£æ³•

å…¶å®žè¿™é“é¢˜çš„è§£æ³•ç›¸å¯¹æ¥è¯´è¿˜æ˜¯å¾ˆå¥½æƒ³çš„ï¼Œåªæ˜¯æ¶‰åŠåˆ°æµ®ç‚¹æ•°çš„å¤„ç†éžå¸¸çƒ¦äººã€‚

ç®€å•éš¾åº¦æˆ‘æƒ³åˆ°äº†ä¸¤ç§è§£æ³•ï¼Œè¿™é‡Œä¸»è¦è¯´å…¶ä¸­ä¸€ç§ï¼Œå¦ä¸€ç§åªç®€å•æä¸€ä¸‹ã€‚  
å‡è®¾ä¸¤åªå°çŒªçš„åæ ‡åˆ†åˆ«ä¸º $(x_1, y_1), (x_2, y_2)$ ç”±æ­¤æˆ‘ä»¬å¯ä»¥ç®—å‡ºç»è¿‡ä»–ä»¬çš„æŠ›ç‰©çº¿å‚æ•° $a, b$  
æ¯ä¸¤åªå°çŒªéƒ½å¯ä»¥ç®—å‡ºè¿™æ ·ä¸€å¯¹ $a, b$ ï¼Œæ˜¾ç„¶å¦‚æžœä¸¤å¯¹å°çŒªç®—å‡ºçš„ $a, b$ ç›¸ç­‰ï¼Œé‚£ä¹ˆä»–ä»¬å°±åœ¨åŒä¸€æ¡æŠ›ç‰©çº¿ä¸Šã€‚  
è€Œæˆ‘ä»¬éœ€è¦éåŽ†ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡ç®—å‡º $a, b$ ï¼Œç¬¬äºŒæ¬¡è¿›è¡Œæ¯”è¾ƒï¼Œè¿™æ ·å°±å¯ä»¥ç¡®å®šæœ€å¤šä¸€æ¬¡å¯ä»¥æ‰“åˆ°å¤šå°‘åªå°çŒªäº†ã€‚

ä¸‹é¢è¯´ä¸€äº›ç»†èŠ‚ã€‚  

1. æµ®ç‚¹æ•°çš„å¤„ç†

    ç”±äºŽç²¾åº¦çš„å½±å“ï¼Œä¸¤å¯¹æœ¬æ¥åœ¨åŒä¸€ç›´çº¿ä¸Šçš„å°çŒªç®—å‡ºæ¥çš„ $a, b$ å¯èƒ½æœ‰å¾®å°å·®å¼‚ï¼Œè¿™æ—¶å¦‚æžœç›´æŽ¥æ¯”è¾ƒå°±ä¼šå¾—åˆ°ä¸ç›¸ç­‰çš„ç»“æžœã€‚ä¸ºäº†å¤„ç†è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªæ¯”è¾ƒå°çš„è¯¯å·®å€¼ã€‚  
    è¯¯å·®å€¼å¯ä»¥æ˜¯ç»å¯¹è¯¯å·®æˆ–ç›¸å¯¹è¯¯å·®ã€‚ç†è®ºä¸Šå¯¹äºŽæµ®ç‚¹æ•°ä½¿ç”¨ç›¸å¯¹è¯¯å·®æ›´å¥½ï¼Œä½†ä¸ºäº†ç®€ä¾¿æˆ‘ä½¿ç”¨äº†ç»å¯¹è¯¯å·®ã€‚å½“ $|a-b|<\delta$ æ—¶ï¼Œæˆ‘ä»¬å°±è®¤ä¸º $a, b$ ç›¸ç­‰ã€‚è¿™é‡Œçš„ $\delta$ å‚è€ƒå®žçŽ°å–çš„æ˜¯ $10^{-6}$ ï¼Œä½†å°±è¿™å‡ ç»„æµ‹è¯•æ•°æ®è€Œè¨€ï¼Œåªè¦å– $10^{-4}\le\delta\le10^{-7}$ å°±å¯ä»¥è¿‡ã€‚

2. $a, b$ çš„è®¡ç®—

    è®¾æŠ›ç‰©çº¿ $y=ax^2+bx$ è¿‡ $(x_1, y_1), (x_2, y_2)$ ä¸¤ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥è§£å¾—ï¼š
    $$a=\frac {x_2y_1-x_1y_2} {x_1^2x_2-x_1x_2^2}, b=\frac {x_1^2y_2-x_2^2y_1} {x_1^2x_2 - x_1x_2^2}$$

3. ä¸¤åªå°çŒª $x$ åæ ‡ç›¸ç­‰æ—¶çš„å¤„ç†

    ç”±äºŽè¦æ±‚ $a<0$ ï¼ŒåŠæŠ›ç‰©çº¿å¼€å£å‘ä¸‹ï¼Œæˆ‘ä»¬è¿™æ—¶æŠŠè¿™æ¡æŠ›ç‰©çº¿çš„ $a$ èµ‹å€¼ä¸ºä»»æ„ä¸€ä¸ªå¤§äºŽ $0$ çš„æ•°ï¼Œä¹‹åŽè®¡ç®—æ—¶å°±ä¼šè¢«å¿½ç•¥æŽ‰äº†ã€‚

4. å…³äºŽæ•°æ®èŒƒå›´

    è™½ç„¶è¿™ç§è§£æ³•æ˜¯ $O(n^3)$ çš„ï¼Œä½†æ˜¯ç”±äºŽæŸäº›éžå¸¸å¼ºçš„åˆ¤æ–­æ¡ä»¶ï¼ˆæˆ‘è¯´çš„æ˜¯ $a\ge0$ï¼‰ï¼Œä½¿å¾—è¿™ç§æ–¹æ³•åœ¨ $n\le1000$ æ—¶ä¹Ÿå¯ä»¥åœ¨ä¸€ç§’å†…è·‘å®Œã€‚ä¹‹å‰é¢˜ç›®ç»™å‡ºçš„ $n\le300$ æ˜¯é€šå¸¸è€Œè¨€ä¸€ä¸ª $O(n^3)$ çš„ç®—æ³•åœ¨ä¸€ç§’å†…å¯ä»¥è·‘çš„æ•°æ®è§„æ¨¡ã€‚ï¼ˆå› ä¸ºå½“æ—¶æˆ‘è¿žç­”æ¡ˆéƒ½è¿˜æ²¡å†™å°±åªæœ‰å‡­ç»éªŒã€‚ã€‚ã€‚ï¼‰

è‡³äºŽå¦å¤–ä¸€ç§æ–¹æ³•ï¼Œå°±æ˜¯å…ˆç®—å‡ºä¸€æ¡æŠ›ç‰©çº¿å†æ¯ä¸ªç‚¹å¸¦å…¥æ–¹ç¨‹éªŒè¯æ˜¯å¦åœ¨è¿™æ¡æŠ›ç‰©çº¿ä¸Šã€‚è¿™ç§æ–¹æ³•ä¹Ÿæ˜¯ $O(n^3)$ çš„æ—¶é—´å¤æ‚åº¦ï¼Œå…·ä½“å“ªç§æ›´å¿«æˆ‘ä¹Ÿæ²¡è¯•è¿‡ã€‚

### å¤æ‚éš¾åº¦è§£æ³•

ä¹‹å‰æåˆ°æˆ‘ä»¬éœ€è¦æŠŠç»è¿‡æ¯ä¸€å¯¹å°çŒªçš„æŠ›ç‰©çº¿è®¡ç®—å‡ºæ¥ï¼Œè¿™æ—¶æˆ‘ä»¬åªéœ€è¦æŠŠè¿™ä¸ªæŠ›ç‰©çº¿å­˜å…¥ä¸€ä¸ª std::map ä¸­ï¼Œç„¶åŽçœ‹å…¶ä¸­å“ªä¸ªæŠ›ç‰©çº¿å‡ºçŽ°å¾—æœ€å¤šå³å¯ã€‚è¿™ç§æ–¹æ³•æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n^2\log n)$ ï¼Œå¯ä»¥å¤„ç† $n\le 2000$ çš„æ•°æ®ã€‚  
æ³¨æ„åˆ°è¿™é‡Œéœ€è¦ç”¨ä¸€ä¸ªç»“æž„ä½“æ¥å­˜å‚¨ä¸€ç»„çš„ $a, b$ ï¼Œå¹¶ä¸”éœ€è¦é‡è½½å°äºŽè¿ç®—ç¬¦æ‰èƒ½æ”¾è¿› std::map ä¸­ã€‚åŒæ—¶éœ€è¦æ³¨æ„ï¼Œå‡è®¾æŸæ¡æŠ›ç‰©çº¿ä¸Šçš„å°çŒªæœ‰ $n$ åªï¼Œè¿™é‡Œçš„ std::map é‡Œçš„ç»“æžœç­‰äºŽ $\frac{n(n-1)}{2}$ ï¼Œå³ä¸¤ä¸¤æˆå¯¹çš„å¯¹æ•°ï¼Œå› æ­¤éœ€è¦ç”±å¯¹æ•°åè¿‡æ¥ç®—å‡ºåªæ•°ã€‚è‡³äºŽå…·ä½“æ€Žä¹ˆåšå¯ä»¥åŽ»çœ‹å‚è€ƒå®žçŽ°ã€‚

### ä¸å¯èƒ½éš¾åº¦è§£æ³•

æˆ‘ä»¬åªéœ€è¦æŠŠ std::map æ¢æˆ std::unordered_map å°±è¡Œäº†ï¼Œå½“ç„¶è¿™æ—¶è¦å†™å“ˆå¸Œå‡½æ•°å¹¶é‡è½½ç­‰äºŽè¿ç®—ç¬¦ã€‚å…·ä½“å®žçŽ°åŒæ ·è§æºç ã€‚

ä¸¥æ ¼æ¥è¯´è¿™å¹¶ä¸æ˜¯ä¸€ç§æ­£ç¡®çš„æ–¹æ³•ã€‚è‡³äºŽé”™åœ¨å“ªé‡Œæˆ‘å°±ä¸è¯´äº†ã€‚ðŸ˜‚  
å¦‚æžœæœ‰å“ªä½ dailao å¯ä»¥æƒ³å‡ºå¦ä¸€ç§ $O(n^2)$ çš„æ–¹æ³•æ¬¢è¿Žåœ¨å­¦æœ¯äº¤æµç¾¤é‡Œåˆ†äº«ã€‚

### æ³¨

- å‚è€ƒå®žçŽ°çš„ç®€å•éš¾åº¦æ˜¯ç”¨çº¯ C å®žçŽ°çš„ï¼Œå¤æ‚éš¾åº¦ä¸º C++98 ï¼Œä¸å¯èƒ½éš¾åº¦ä¸º C++11ã€‚åŽä¸¤ç§å¯èƒ½éœ€è¦äº†è§£ä¸€äº›é¢å¤–çŸ¥è¯†æ‰èƒ½çœ‹æ‡‚æºç ã€‚
- æµ‹è¯•æ•°æ®ä¸­ï¼ŒD*.txt ä¸ºæ‰‹ç®—çº§åˆ«ï¼ˆDebug ç”¨ï¼‰ï¼ŒE*.txt ä¸ºç®€å•éš¾åº¦ï¼ŒH*.txt ä¸ºå¤æ‚éš¾åº¦ï¼ŒI*.txt ä¸ºä¸å¯èƒ½éš¾åº¦ï¼Œè¯·æ³¨æ„ $n$ çš„å¤§å°ä»¥é˜²æº¢å‡ºã€‚


æ„Ÿè°¢çœ‹åˆ°è¿™é‡Œçš„ä½ ï½ž
